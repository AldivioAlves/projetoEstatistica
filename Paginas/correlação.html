<!DOCTYPE html>
<html>

<head>
    <meta charset="utf8" />
    <LINK href="../bootstrap-4.1.3-dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
</head>
<style type="text/css">
    .valoresVariaveis {
        display: inline
    }

    #nomeIndependente,
    #nomeDependente {
        display: inline
    }
</style>

<body>
    <p class="valoresVariaveis" id='nomeIndependente'>

    </p>
    <input type="text" size=30 id='VarIndependente' onclick="document.getElementById('VarDependente').value=''" />
    <button onclick="projeções()">Projetar</button>

    <input type="text" size="30" id='VarDependente' onclick="document.getElementById('VarIndependente').value=''" />
    <p class="valoresVariaveis" id=nomeDependente>

    </p>
</body>
<script>
    VtoP = function (n) {

        for (j = 0; j < n.length; j++) {
            if (n[j] == ',') {
                n = n.replace(n[j], '.')

            }
        }
        return n
    }


    x = JSON.parse(window.localStorage.getItem('dadosCorrelação')).x
    y = JSON.parse(window.localStorage.getItem('dadosCorrelação')).y
    nomeX = document.getElementById('nomeIndependente').innerText = JSON.parse(window.localStorage.getItem('dadosCorrelação')).nomeX
    nomeY = document.getElementById('nomeDependente').innerText = JSON.parse(window.localStorage.getItem('dadosCorrelação')).nomeY


    //acumuladores 

    acX = 0
    acY = 0
    acXpow = 0
    acYpow = 0
    acXxY = 0

    for (i = 0; i < x.length; i++) {
        acX += x[i]
        acY += y[i]
        acXpow += Math.pow(x[i], 2)
        acYpow += Math.pow(y[i], 2)
        acXxY += x[i] * y[i]
    }
    //numero dupla x y pesquisada
    n = x.length

    //formula r

    r = (n * acXxY - acX * acY) / Math.sqrt((n * acXpow - Math.pow(acX, 2)) * (n * acYpow - Math.pow(acY, 2)))

    //constantes

    a = (n * acXxY - acX * acY) / (n * acXpow - Math.pow(acX, 2))
    b = (acY / n) - a * (acX / n)

    projeções = function () {
        varX = VtoP(document.getElementById('VarIndependente').value)
        if (isNaN(varX)) {
            alert('Dados incorretos!\nDigite um numero na entrada da variavel ' + nomeX)
            return
        }


        varY = VtoP(document.getElementById('VarDependente').value)
        if (isNaN(varY)) {
            alert('Dados incorretos!\nDigite um numero na entrada da variavel ' + nomeY)
            return
        }



        if (varX != '') {
            idVar = 'VarDependente'
            calculoProjeção = a * parseFloat(varX) + b
        }
        if (varY != '') {
            idVar = 'VarIndependente'
            calculoProjeção = (parseFloat(varY) - b) / a

        }
        document.getElementById(idVar).value = calculoProjeção

    }
    limpar = function () {
        if (document.getElementById('VarIndependente').value = !null) {
            document.getElementById('VarIndependente').value = ''
        }
        if (document.getElementById('VarDependente').value = !null) {
            document.getElementById('VarDependente').value = ''
        }
    }


</script>

</html>